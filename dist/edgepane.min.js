/*!
 * EdgePane Sidebar (EGP version)
 * ------------------------------------
 * A lightweight, responsive, customizable sidebar
 * with dropdowns, branding, overlay, and theming.
 *
 * Version: 1.0.0
 * Author: Your Name / Team
 * License: MIT
 *
 * Features:
 * - Initialize sidebar with egpSidebar.init({...})
 * - Toggle open/closed states
 * - Dropdown menus (single or multi)
 * - Overlay for mobile
 * - Remember dropdown state (optional)
 * - Callbacks for events (onToggle, onDropdown, etc.)
 *
 * Usage:
 *  egpSidebar.init({
 *    sidebarState: "open",        // "open" | "closed"
 *    hoverExpand: true,           // expand on hover
 *    closeOnClickOutside: true,   // overlay behavior
 *    dropdownMode: "single",      // or "multi"
 *    rememberDropdowns: true
 *  });
 *
 * Dependencies:
 *  - jQuery (required)
 *  - Bootstrap Icons (optional, for icons)
 *
 * ------------------------------------
 * NOTE: This is the MINIFIED build.
 * For readable code, see /src/edgepane.js
 */
((e,t)=>{"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):e.edgePane=t(e.jQuery)})(this,function(m){let u={config:{dropdownMode:"multi",sidebarState:"open",hoverExpand:!0,closeOnClickOutside:!0,rememberDropdowns:!0,sidebarColor:"rgba(225,225,225,1)",fontFamily:"'Montserrat', sans-serif",sidebarWidth:"16rem",textColor:"rgba(70,70,70,1)",activeLinkBg:"rgba(180,180,180,1)",activeLinkColor:"rgba(70,70,70,1)",showBrand:!0,brand:{brandLogoSrc:"",brandName:"",brandTagline:""},onSidebarToggle:function(e){},onDropdownToggle:function(e,t){}},init(e={}){this.config=m.extend(!0,{},this.config,e);let t=m(".egp-sidebar"),o=m(".egp-sidebar-overlay");e=m(".egp-sidebar-toggle");let i=m(".egp-main-content"),n=m(".egp-sidebar-dropdown");var a=m(".egp-sidebar-logo"),r=m(".egp-sidebar-header");let s="sidebar-state",d="sidebar-dropdowns",l=!1,c=(m(document).on("click",".egp-sidebar-link",function(){var e=m(this).find(".egp-sidebar-link-text").text().trim();localStorage.setItem("active-link-key",e),m(".egp-sidebar-link").removeClass("active"),m(this).addClass("active")}),m(".egp-sidebar-link").map(function(){var e=m(this).attr("href");if(!e||"#"===e)return null;let t=new URL(e,window.location.origin).pathname;return t=t.replace(/^\/|\/$/g,"")}).get());console.log(c);let g=(e=>{if(e=e.split(/[?#]/)[0].split("/").filter(Boolean),console.log(e),e.length){var t=e[e.length-1].toLowerCase();if(c.includes(t))return t;if(2<=e.length){t=e.slice(-2).join("/").toLowerCase();if(c.includes(t))return t}}return null})(window.location.pathname.replace(/\/$/,""));console.log(g),console.log("Best match:",g);var f=m(".egp-sidebar-link").filter(function(){var e=m(this).attr("href");return!(!e||"#"===e)&&(e=e.replace(/^\.\//,""),console.log(e),e===g)}).first();m(".egp-sidebar-link").removeClass("active"),(f.length?f:m(".egp-sidebar-link").first()).addClass("active"),m(":root").css("--sidebar-width-open",this.config.sidebarWidth),m(":root").css({"--sidebar-color":this.config.textColor,"--sidebar-bg-active":this.config.activeLinkBg,"--sidebar-color-active":this.config.activeLinkColor}),this.config.showBrand?r.show():r.hide(),this.config.brand.brandLogoSrc&&a.attr("src",this.config.brand.brandLogoSrc),this.config.brand.brandName&&m(".egp-sidebar-brand-name").text(this.config.brand.brandName),this.config.brand.brandTagline&&m(".egp-sidebar-brand-tagline").text(this.config.brand.brandTagline),t.css({background:this.config.sidebarColor,fontFamily:this.config.fontFamily});let p=this.config.sidebarState,h=(this.config.rememberDropdowns&&(p=localStorage.getItem(s)||this.config.sidebarState),m(window).width()<=1023&&(p="closed"),t.attr("data-state",p),w(p),[]);function b(e){t.attr("data-state",e),w(e),u.config.rememberDropdowns&&localStorage.setItem(s,e),m(window).width()<=1023&&o.toggleClass("show","open"===e),u.config.onSidebarToggle(e)}function w(e){1023<m(window).width()?"open"===e?i.addClass("shifted").removeClass("compact"):i.addClass("compact").removeClass("shifted"):i.removeClass("shifted compact")}this.config.rememberDropdowns&&(h=JSON.parse(localStorage.getItem(d)||"[]")),"multi"===this.config.dropdownMode?h.forEach(e=>m("#"+e).addClass("open")):h.length&&m("#"+h[0]).addClass("open"),e.on("click",()=>{b("open"===t.attr("data-state")?"closed":"open")}),this.config.closeOnClickOutside&&o.on("click",()=>b("closed")),n.each((e,t)=>{let o=m(t),i=o.find(".egp-dropdown-toggle").first();i.on("click",()=>{var e,t=o.hasClass("open");"single"===u.config.dropdownMode&&(n.not(o).removeClass("open").find(".egp-dropdown-toggle").attr("aria-expanded","false"),n.not(o).find(".egp-dropdown-content").attr("aria-hidden","true")),o.toggleClass("open"),i.attr("aria-expanded",String(!t)),o.find(".egp-dropdown-content").attr("aria-hidden",String(t)),u.config.rememberDropdowns&&(e=n.filter(".open").map((e,t)=>m(t).attr("id")).get(),localStorage.setItem(d,JSON.stringify(e))),u.config.onDropdownToggle(o.attr("id"),!t)})}),this.config.hoverExpand&&(t.on("mouseenter",()=>{1023<m(window).width()&&"closed"===t.attr("data-state")&&(t.attr("data-state","open"),l=!0)}),t.on("mouseleave",()=>{1023<m(window).width()&&l&&(t.attr("data-state","closed"),l=!1)})),m(window).on("resize",()=>{w(t.attr("data-state")),1023<m(window).width()&&o.removeClass("show")})}};return u});
